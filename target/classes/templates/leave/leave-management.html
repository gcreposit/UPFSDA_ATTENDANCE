<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{fragments/layout :: head}">
    <title>Leave Management - UPFSDA Attendance System</title>
</head>
<body>
<!-- Sidebar -->
<nav th:replace="~{fragments/layout :: sidebar}"></nav>

<!-- Header -->
<header th:replace="~{fragments/layout :: header}"></header>

<!-- Main Content (Admin Only) -->
<main class="main-content">
    <!-- Page Header -->
    <div class="page-header mb-4">
        <div class="row align-items-center">
            <div class="col-md-12">
                <h2 class="page-title">
                    <i class="fas fa-calendar-alt me-2"></i>Leave Management (Admin)
                </h2>
                <p class="page-subtitle text-muted">
                    Manage and review all employee leave requests
                </p>
            </div>
        </div>
    </div>

    <!-- Filters -->
    <!--        <div class="card mb-4">-->
    <!--            <div class="card-content">-->
    <!--                <div class="row align-items-center">-->
    <!--                    <div class="col-md-3">-->
    <!--                        <label for="statusFilter" class="form-label">Filter by Status</label>-->
    <!--                        <select id="statusFilter" class="form-control">-->
    <!--                            <option value="">All Status</option>-->
    <!--                            <option value="Pending">Pending</option>-->
    <!--                            <option value="Approved">Approved</option>-->
    <!--                            <option value="Denied">Denied</option>-->
    <!--                        </select>-->
    <!--                    </div>-->
    <!--                    <div class="col-md-3">-->
    <!--                        <label for="employeeFilter" class="form-label">Filter by Employee</label>-->
    <!--                        <select id="employeeFilter" class="form-control">-->
    <!--                            <option value="">All Employees</option>-->
    <!--                            &lt;!&ndash; dynamically load employees &ndash;&gt;-->
    <!--                        </select>-->
    <!--                    </div>-->
    <!--                    <div class="col-md-3">-->
    <!--                        <label class="form-label">&nbsp;</label>-->
    <!--                        <div>-->
    <!--                            <button class="btn btn-secondary" onclick="clearFilters()">-->
    <!--                                <i class="fas fa-times me-2"></i>Clear Filters-->
    <!--                            </button>-->
    <!--                        </div>-->
    <!--                    </div>-->
    <!--                </div>-->
    <!--            </div>-->
    <!--        </div>-->

    <!-- Leave Requests -->
    <div class="card">
        <div class="card-header">
            <h5 class="card-title mb-0">
                <i class="fas fa-list me-2"></i>All Leave Requests
            </h5>
        </div>
        <div class="card-content">
            <div id="leaveRequestsList" class="table-responsive">
                <table class="table table-striped table-hover align-middle" id="leaveRequests">
                    <thead>
                    <tr>
                        <th>Employee</th>
                        <th>From Date</th>
                        <th>To Date</th>
                        <th>Duration</th>
                        <th>Reason</th>
                        <th>Status</th>
                        <th hidden>Approved By</th>
                        <th hidden class="text-center">Actions</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr th:each="leave : ${leaveList}">
                        <td th:text="${leave.username}">john.doe</td>
                        <td th:text="${leave.startDate}">john.doe</td>
                        <td th:text="${leave.endDate}">john.doe</td>
                        <td th:text="${leave.durationType}">FULL_DAY</td>
                        <td th:text="${leave.reason}">Personal work</td>
                        <td>
                <span class="badge"
                      th:classappend="${leave.status} == 'PENDING' ? 'bg-warning' :
                                      (${leave.status} == 'APPROVED' ? 'bg-success' : 'bg-danger')"
                      th:text="${leave.status}">
                    PENDING
                </span>
                        </td>
                        <td hidden th:text="${leave.approvedBy != null ? leave.approvedBy : '-'}">-</td>
                        <td hidden class="text-center">
                            <div th:if="${leave.status == 'PENDING'}">
                                <form th:action="@{/admin/leave/approve/{id}(id=${leave.id})}" method="post"
                                      class="d-inline">
                                    <button type="submit" class="btn btn-success btn-sm">
                                        <i class="fas fa-check"></i>
                                    </button>
                                </form>
                                <form th:action="@{/admin/leave/deny/{id}(id=${leave.id})}" method="post"
                                      class="d-inline">
                                    <button type="submit" class="btn btn-danger btn-sm">
                                        <i class="fas fa-times"></i>
                                    </button>
                                </form>
                            </div>
                            <span th:if="${leave.status != 'PENDING'}" class="text-muted">â€”</span>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</main>

<!-- Footer -->
<footer th:replace="~{fragments/layout :: footer}"></footer>

<!-- Scripts -->
<div th:replace="~{fragments/layout :: scripts}"></div>

</body>
</html>